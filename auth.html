<!DOCTYPE html>
<html lang=\"en\">
<head>
  <meta charset=\"utf-8\" />
  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />
  <title>WOLCAS Auth</title>
  <!-- Updated CSP (Option A: quick) -->
  <meta http-equiv=\"Content-Security-Policy\" content=\"
    default-src 'self';
    img-src 'self' data:;
    style-src 'self' 'unsafe-inline';
    script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://alcdn.msauth.net https://aadcdn.msftauth.net;
    connect-src 'self' https://login.microsoftonline.com https://alcdn.msauth.net https://aadcdn.msftauth.net;
    frame-src 'self' https://login.microsoftonline.com https://alcdn.msauth.net https://aadcdn.msftauth.net;
    form-action 'self' https://login.microsoftonline.com;
  \" />
  <style>body{margin:0;background:#fff;color:#222;font-family:system-ui;display:flex;align-items:center;justify-content:center;height:100vh}</style>
  <!-- MSAL Browser -->
  <script src=\"https://cdn.jsdelivr.net/npm/@azure/msal-browser@3.11.1/dist/msal-browser.min.js\"></script>
</head>
<body>
  <div>Authenticatingâ€¦</div>
  <script>
    const msalInstance = new msal.PublicClientApplication({
      auth: {
        clientId: \"827656f8-3a21-4d69-b6e5-c35e2ec2fb71\",
        authority: \"https://login.microsoftonline.com/97d84781-b85c-4034-a0d0-588e7b442e45\",
        redirectUri: \"https://abirrahat.github.io/wolcas-webapp/auth\"
      },
      cache: { cacheLocation: \"sessionStorage\", storeAuthStateInCookie: false },
      system: { allowRedirectInIframe: true }
    });
    msalInstance.handleRedirectPromise()
      .finally(() => { if (window.opener && !window.opener.closed) window.close(); });
  </script>
</body>
</html>
