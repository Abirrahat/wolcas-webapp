<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WOLCAS Auth</title>
  <style>body{font-family:system-ui,Segoe UI,Arial;padding:24px;color:#374151;} .muted{color:#6b7280}</style>
</head>
<body>
  <h1>WOLCAS Auth</h1>
  <p class="muted">Authenticatingâ€¦ This window will close automatically.</p>

  <!-- Local MSAL (no external CDNs) -->
  <script src="./msal-browser.min.js"></script>
  <script>
    const msalConfig = {
      auth: {
        clientId: '827656f8-3a21-4d69-b6e5-c35e2ec2fb71',
        authority: 'https://login.microsoftonline.com/97d84781-b85c-4034-a0d0-588e7b442e45',
        redirectUri: 'https://abirrahat.github.io/wolcas-webapp/auth',
        navigateToLoginRequestUrl: false
      },
      cache: { cacheLocation: 'sessionStorage', storeAuthStateInCookie: false },
      system: { allowRedirectInIframe: true }
    };
    const msalInstance = new msal.PublicClientApplication(msalConfig);
    msalInstance.handleRedirectPromise()
      .then((resp)=>{
        if (resp && window.opener) {
          try { window.opener.postMessage({ type:'MSAL_AUTH_SUCCESS', account: resp.account }, '*'); } catch(e){}
        }
        setTimeout(()=>window.close(), 300);
      })
      .catch((err)=>{
        console.error(err);
        setTimeout(()=>window.close(), 800);
      });
  </script>
</body>
</html>
